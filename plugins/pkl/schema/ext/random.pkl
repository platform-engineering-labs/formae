/*
 * Â© 2025 Platform Engineering Labs Inc.
 *
 * SPDX-License-Identifier: FSL-1.1-ALv2
 */

module Random

import "pkl:json"

/// id: get a secure random number of fixed length
function id(length: Number?): Number =
  let (uri = "libext:///random/id?length=\(length ?? 2.toString())")
  let (result = new json.Parser{}.parse(read(uri)))
    if (result.hasProperty("Error"))
      throw("random.id error: \(result.getProperty("Error"))")
      else
      result.getProperty("Body").getProperty("id")

/// password: get a secure random password of fixed length
function password(length: Number?, useSpecial: Boolean): String =
  let (uri = "libext:///random/password?length=\(length ?? 12.toString())&useSpecial=\(useSpecial.toString())")
    let (result = new json.Parser{}.parse(read(uri)))
      if (result.hasProperty("Error"))
        throw("random.password error: \(result.getProperty("Error"))")
      else
        result.getProperty("Body").getProperty("password")