{
  "Targets": [
    {
      "Label": "aws-target",
      "Namespace": "AWS",
      "Config": {
        "Type": "AWS",
        "Region": "us-west-2"
      }
    }
  ],
  "Resources": [
    {
      "Label": "Database",
      "Type": "AWS::RDS::DBInstance",
      "Stack": "secret-resolution",
      "Target": "aws-target",
      "Schema": {
        "Identifier": "DBInstanceIdentifier",
        "Tags": "Tags",
        "Fields": [
          "AllocatedStorage",
          "AllowMajorVersionUpgrade",
          "AssociatedRoles",
          "AutoMinorVersionUpgrade",
          "AutomaticBackupReplicationKmsKeyId",
          "AutomaticBackupReplicationRegion",
          "AvailabilityZone",
          "BackupRetentionPeriod",
          "CACertificateIdentifier",
          "CertificateDetails",
          "CertificateRotationRestart",
          "CharacterSetName",
          "CopyTagsToSnapshot",
          "CustomIAMInstanceProfile",
          "DBClusterIdentifier",
          "DBClusterSnapshotIdentifier",
          "DBInstanceClass",
          "DBInstanceIdentifier",
          "DBName",
          "DBParameterGroupName",
          "DBSecurityGroups",
          "DBSnapshotIdentifier",
          "DBSubnetGroupName",
          "DBSystemId",
          "DedicatedLogVolume",
          "DeleteAutomatedBackups",
          "DeletionProtection",
          "Domain",
          "DomainAuthSecretArn",
          "DomainDnsIps",
          "DomainFqdn",
          "DomainIAMRoleName",
          "DomainOu",
          "EnableCloudwatchLogsExports",
          "EnableIAMDatabaseAuthentication",
          "EnablePerformanceInsights",
          "Endpoint",
          "Engine",
          "EngineLifecycleSupport",
          "EngineVersion",
          "Iops",
          "KmsKeyId",
          "LicenseModel",
          "ManageMasterUserPassword",
          "MasterUserPassword",
          "MasterUserSecret",
          "MasterUsername",
          "MaxAllocatedStorage",
          "MonitoringInterval",
          "MonitoringRoleArn",
          "MultiAZ",
          "NcharCharacterSetName",
          "NetworkType",
          "OptionGroupName",
          "PerformanceInsightsKMSKeyId",
          "PerformanceInsightsRetentionPeriod",
          "Port",
          "PreferredBackupWindow",
          "PreferredMaintenanceWindow",
          "ProcessorFeatures",
          "PromotionTier",
          "PubliclyAccessible",
          "ReplicaMode",
          "RestoreTime",
          "SourceDBClusterIdentifier",
          "SourceDBInstanceAutomatedBackupsArn",
          "SourceDBInstanceIdentifier",
          "SourceDbiResourceId",
          "SourceRegion",
          "StorageEncrypted",
          "StorageThroughput",
          "StorageType",
          "Tags",
          "TdeCredentialArn",
          "TdeCredentialPassword",
          "Timezone",
          "UseDefaultProcessorFeatures",
          "UseLatestRestorableTime",
          "VPCSecurityGroups"
        ],
        "Nonprovisionable": false,
        "Hints": {
          "AllocatedStorage": {
            "CreateOnly": false,
            "Persist": false,
            "WriteOnly": false,
            "Required": false
          },
          "AllowMajorVersionUpgrade": {
            "CreateOnly": false,
            "Persist": false,
            "WriteOnly": true,
            "Required": false
          },
          "AssociatedRoles": {
            "CreateOnly": false,
            "Persist": false,
            "WriteOnly": false,
            "Required": false
          },
          "AutoMinorVersionUpgrade": {
            "CreateOnly": false,
            "Persist": false,
            "WriteOnly": false,
            "Required": false
          },
          "AutomaticBackupReplicationKmsKeyId": {
            "CreateOnly": false,
            "Persist": false,
            "WriteOnly": true,
            "Required": false
          },
          "AutomaticBackupReplicationRegion": {
            "CreateOnly": false,
            "Persist": false,
            "WriteOnly": false,
            "Required": false
          },
          "AvailabilityZone": {
            "CreateOnly": false,
            "Persist": false,
            "WriteOnly": false,
            "Required": false
          },
          "BackupRetentionPeriod": {
            "CreateOnly": false,
            "Persist": false,
            "WriteOnly": false,
            "Required": false
          },
          "CACertificateIdentifier": {
            "CreateOnly": false,
            "Persist": false,
            "WriteOnly": false,
            "Required": false
          },
          "CertificateDetails": {
            "CreateOnly": false,
            "Persist": false,
            "WriteOnly": false,
            "Required": false
          },
          "CertificateRotationRestart": {
            "CreateOnly": false,
            "Persist": false,
            "WriteOnly": true,
            "Required": false
          },
          "CharacterSetName": {
            "CreateOnly": true,
            "Persist": false,
            "WriteOnly": false,
            "Required": false
          },
          "CopyTagsToSnapshot": {
            "CreateOnly": false,
            "Persist": false,
            "WriteOnly": false,
            "Required": false
          },
          "CustomIAMInstanceProfile": {
            "CreateOnly": true,
            "Persist": false,
            "WriteOnly": false,
            "Required": false
          },
          "DBClusterIdentifier": {
            "CreateOnly": true,
            "Persist": false,
            "WriteOnly": false,
            "Required": false
          },
          "DBClusterSnapshotIdentifier": {
            "CreateOnly": false,
            "Persist": false,
            "WriteOnly": false,
            "Required": false
          },
          "DBInstanceClass": {
            "CreateOnly": false,
            "Persist": false,
            "WriteOnly": false,
            "Required": false
          },
          "DBInstanceIdentifier": {
            "CreateOnly": false,
            "Persist": false,
            "WriteOnly": true,
            "Required": false
          },
          "DBName": {
            "CreateOnly": true,
            "Persist": false,
            "WriteOnly": false,
            "Required": false
          },
          "DBParameterGroupName": {
            "CreateOnly": false,
            "Persist": false,
            "WriteOnly": false,
            "Required": false
          },
          "DBSecurityGroups": {
            "CreateOnly": false,
            "Persist": false,
            "WriteOnly": false,
            "Required": false
          },
          "DBSnapshotIdentifier": {
            "CreateOnly": false,
            "Persist": false,
            "WriteOnly": false,
            "Required": false
          },
          "DBSubnetGroupName": {
            "CreateOnly": true,
            "Persist": false,
            "WriteOnly": false,
            "Required": false
          },
          "DBSystemId": {
            "CreateOnly": true,
            "Persist": false,
            "WriteOnly": false,
            "Required": false
          },
          "DedicatedLogVolume": {
            "CreateOnly": false,
            "Persist": false,
            "WriteOnly": false,
            "Required": false
          },
          "DeleteAutomatedBackups": {
            "CreateOnly": false,
            "Persist": false,
            "WriteOnly": true,
            "Required": false
          },
          "DeletionProtection": {
            "CreateOnly": false,
            "Persist": false,
            "WriteOnly": false,
            "Required": false
          },
          "Domain": {
            "CreateOnly": false,
            "Persist": false,
            "WriteOnly": false,
            "Required": false
          },
          "DomainAuthSecretArn": {
            "CreateOnly": false,
            "Persist": false,
            "WriteOnly": false,
            "Required": false
          },
          "DomainDnsIps": {
            "CreateOnly": false,
            "Persist": false,
            "WriteOnly": false,
            "Required": false
          },
          "DomainFqdn": {
            "CreateOnly": false,
            "Persist": false,
            "WriteOnly": false,
            "Required": false
          },
          "DomainIAMRoleName": {
            "CreateOnly": false,
            "Persist": false,
            "WriteOnly": false,
            "Required": false
          },
          "DomainOu": {
            "CreateOnly": false,
            "Persist": false,
            "WriteOnly": false,
            "Required": false
          },
          "EnableCloudwatchLogsExports": {
            "CreateOnly": false,
            "Persist": false,
            "WriteOnly": false,
            "Required": false
          },
          "EnableIAMDatabaseAuthentication": {
            "CreateOnly": false,
            "Persist": false,
            "WriteOnly": false,
            "Required": false
          },
          "EnablePerformanceInsights": {
            "CreateOnly": false,
            "Persist": false,
            "WriteOnly": false,
            "Required": false
          },
          "Endpoint": {
            "CreateOnly": false,
            "Persist": false,
            "WriteOnly": false,
            "Required": false
          },
          "Engine": {
            "CreateOnly": false,
            "Persist": false,
            "WriteOnly": false,
            "Required": false
          },
          "EngineLifecycleSupport": {
            "CreateOnly": false,
            "Persist": false,
            "WriteOnly": false,
            "Required": false
          },
          "EngineVersion": {
            "CreateOnly": false,
            "Persist": false,
            "WriteOnly": false,
            "Required": false
          },
          "Iops": {
            "CreateOnly": false,
            "Persist": false,
            "WriteOnly": false,
            "Required": false
          },
          "KmsKeyId": {
            "CreateOnly": true,
            "Persist": false,
            "WriteOnly": false,
            "Required": false
          },
          "LicenseModel": {
            "CreateOnly": false,
            "Persist": false,
            "WriteOnly": false,
            "Required": false
          },
          "ManageMasterUserPassword": {
            "CreateOnly": false,
            "Persist": false,
            "WriteOnly": false,
            "Required": false
          },
          "MasterUserPassword": {
            "CreateOnly": false,
            "Persist": false,
            "WriteOnly": true,
            "Required": false
          },
          "MasterUserSecret": {
            "CreateOnly": false,
            "Persist": false,
            "WriteOnly": false,
            "Required": false
          },
          "MasterUsername": {
            "CreateOnly": true,
            "Persist": false,
            "WriteOnly": false,
            "Required": false
          },
          "MaxAllocatedStorage": {
            "CreateOnly": false,
            "Persist": false,
            "WriteOnly": false,
            "Required": false
          },
          "MonitoringInterval": {
            "CreateOnly": false,
            "Persist": false,
            "WriteOnly": false,
            "Required": false
          },
          "MonitoringRoleArn": {
            "CreateOnly": false,
            "Persist": false,
            "WriteOnly": false,
            "Required": false
          },
          "MultiAZ": {
            "CreateOnly": false,
            "Persist": false,
            "WriteOnly": false,
            "Required": false
          },
          "NcharCharacterSetName": {
            "CreateOnly": true,
            "Persist": false,
            "WriteOnly": false,
            "Required": false
          },
          "NetworkType": {
            "CreateOnly": false,
            "Persist": false,
            "WriteOnly": false,
            "Required": false
          },
          "OptionGroupName": {
            "CreateOnly": false,
            "Persist": false,
            "WriteOnly": false,
            "Required": false
          },
          "PerformanceInsightsKMSKeyId": {
            "CreateOnly": true,
            "Persist": false,
            "WriteOnly": false,
            "Required": false
          },
          "PerformanceInsightsRetentionPeriod": {
            "CreateOnly": false,
            "Persist": false,
            "WriteOnly": false,
            "Required": false
          },
          "Port": {
            "CreateOnly": false,
            "Persist": false,
            "WriteOnly": false,
            "Required": false
          },
          "PreferredBackupWindow": {
            "CreateOnly": false,
            "Persist": false,
            "WriteOnly": false,
            "Required": false
          },
          "PreferredMaintenanceWindow": {
            "CreateOnly": false,
            "Persist": false,
            "WriteOnly": false,
            "Required": false
          },
          "ProcessorFeatures": {
            "CreateOnly": false,
            "Persist": false,
            "WriteOnly": false,
            "Required": false
          },
          "PromotionTier": {
            "CreateOnly": false,
            "Persist": false,
            "WriteOnly": false,
            "Required": false
          },
          "PubliclyAccessible": {
            "CreateOnly": false,
            "Persist": false,
            "WriteOnly": false,
            "Required": false
          },
          "ReplicaMode": {
            "CreateOnly": false,
            "Persist": false,
            "WriteOnly": false,
            "Required": false
          },
          "RestoreTime": {
            "CreateOnly": false,
            "Persist": false,
            "WriteOnly": true,
            "Required": false
          },
          "SourceDBClusterIdentifier": {
            "CreateOnly": false,
            "Persist": false,
            "WriteOnly": false,
            "Required": false
          },
          "SourceDBInstanceAutomatedBackupsArn": {
            "CreateOnly": false,
            "Persist": false,
            "WriteOnly": true,
            "Required": false
          },
          "SourceDBInstanceIdentifier": {
            "CreateOnly": false,
            "Persist": false,
            "WriteOnly": true,
            "Required": false
          },
          "SourceDbiResourceId": {
            "CreateOnly": false,
            "Persist": false,
            "WriteOnly": true,
            "Required": false
          },
          "SourceRegion": {
            "CreateOnly": true,
            "Persist": false,
            "WriteOnly": true,
            "Required": false
          },
          "StorageEncrypted": {
            "CreateOnly": true,
            "Persist": false,
            "WriteOnly": false,
            "Required": false
          },
          "StorageThroughput": {
            "CreateOnly": false,
            "Persist": false,
            "WriteOnly": false,
            "Required": false
          },
          "StorageType": {
            "CreateOnly": false,
            "Persist": false,
            "WriteOnly": false,
            "Required": false
          },
          "Tags": {
            "CreateOnly": false,
            "Persist": false,
            "WriteOnly": false,
            "Required": false
          },
          "TdeCredentialArn": {
            "CreateOnly": false,
            "Persist": false,
            "WriteOnly": false,
            "Required": false
          },
          "TdeCredentialPassword": {
            "CreateOnly": false,
            "Persist": false,
            "WriteOnly": true,
            "Required": false
          },
          "Timezone": {
            "CreateOnly": true,
            "Persist": false,
            "WriteOnly": false,
            "Required": false
          },
          "UseDefaultProcessorFeatures": {
            "CreateOnly": false,
            "Persist": false,
            "WriteOnly": true,
            "Required": false
          },
          "UseLatestRestorableTime": {
            "CreateOnly": false,
            "Persist": false,
            "WriteOnly": true,
            "Required": false
          },
          "VPCSecurityGroups": {
            "CreateOnly": false,
            "Persist": false,
            "WriteOnly": false,
            "Required": false
          }
        },
        "Discoverable": true
      },
      "Properties": {
        "AllocatedStorage": "20",
        "AssociatedRoles": [],
        "AutoMinorVersionUpgrade": true,
        "AvailabilityZone": "us-west-2a",
        "BackupRetentionPeriod": 1,
        "CACertificateIdentifier": "rds-ca-rsa2048-g1",
        "CertificateDetails": {
          "CAIdentifier": "rds-ca-rsa2048-g1",
          "ValidTill": "2026-10-08T13:27:35Z"
        },
        "CopyTagsToSnapshot": false,
        "DBInstanceClass": "db.t3.micro",
        "DBInstanceIdentifier": "rds-h3un6zvbswwsn255dc4qkj6qj-m5l60xaow5zm",
        "DBParameterGroupName": "default.postgres13",
        "DBSecurityGroups": [],
        "DBSubnetGroupName": {
          "$label": "DBSubnetGroup",
          "$property": "DBSubnetGroupName",
          "$res": true,
          "$stack": "secret-resolution",
          "$type": "AWS::RDS::DBSubnetGroup",
          "$value": "secret-resolution-db-subnet-group"
        },
        "DedicatedLogVolume": false,
        "DeletionProtection": false,
        "EnableCloudwatchLogsExports": [],
        "EnableIAMDatabaseAuthentication": false,
        "EnablePerformanceInsights": false,
        "Endpoint": {
          "Address": "rds-h3un6zvbswwsn255dc4qkj6qj-m5l60xaow5zm.cvkk4e0kuaqo.us-west-2.rds.amazonaws.com",
          "HostedZoneId": "Z1PVIF0B656C1W",
          "Port": "5432"
        },
        "Engine": "postgres",
        "EngineLifecycleSupport": "open-source-rds-extended-support",
        "EngineVersion": "13.20",
        "KmsKeyId": "arn:aws:kms:us-west-2:021891619792:key/d18124f0-c4bf-4b7e-8e20-8c574916f009",
        "LicenseModel": "postgresql-license",
        "ManageMasterUserPassword": false,
        "MasterUserPassword": {
          "$label": "DBSecret",
          "$property": "SecretString",
          "$res": true,
          "$stack": "secret-resolution",
          "$type": "AWS::SecretsManager::Secret",
          "$value": "47efbe0559f4c486c94b7c0b4594caf099a8dd061ec4dbad708006025f537f89"
        },
        "MasterUserSecret": {},
        "MasterUsername": "testuser",
        "MonitoringInterval": 0,
        "MultiAZ": false,
        "NetworkType": "IPV4",
        "OptionGroupName": "default:postgres-13",
        "Port": "5432",
        "PreferredBackupWindow": "09:31-10:01",
        "PreferredMaintenanceWindow": "mon:11:39-mon:12:09",
        "ProcessorFeatures": [],
        "PubliclyAccessible": false,
        "StorageEncrypted": true,
        "StorageThroughput": 0,
        "StorageType": "gp2",
        "Tags": [
          {
            "Key": "FormaeResourceLabel",
            "Value": "Database"
          },
          {
            "Key": "FormaeStackLabel",
            "Value": "secret-resolution"
          }
        ],
        "VPCSecurityGroups": [
          "sg-090a90bbbf5d6c1af"
        ]
      },
      "ReadOnlyProperties": {
        "BackupTarget": "region",
        "DBInstanceArn": "arn:aws:rds:us-west-2:021891619792:db:rds-h3un6zvbswwsn255dc4qkj6qj-m5l60xaow5zm",
        "DBInstanceStatus": "available",
        "DatabaseInsightsMode": "standard",
        "DbiResourceId": "db-FJVNBVWLDLHHHEXICFI5H4QNDY",
        "InstanceCreateTime": "2025-10-08T13:29:10.996Z",
        "IsStorageConfigUpgradeAvailable": false,
        "LatestRestorableTime": "2025-10-08T13:30:27.462Z",
        "ReadReplicaDBClusterIdentifiers": [],
        "ReadReplicaDBInstanceIdentifiers": [],
        "StatusInfos": []
      },
      "NativeId": "rds-h3un6zvbswwsn255dc4qkj6qj-m5l60xaow5zm",
      "Managed": true,
      "Ksuid": "33mkwXOGudI6b2hDqo9nobAKrnO"
    }
  ]
}