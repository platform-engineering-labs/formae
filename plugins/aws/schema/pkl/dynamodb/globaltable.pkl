/*
 * Â© 2025 Platform Engineering Labs Inc.
 *
 * SPDX-License-Identifier: FSL-1.1-ALv2
 */

module aws.dynamodb.globaltable

import "@formae/formae.pkl"
import "../aws.pkl"

const type = "AWS::DynamoDB::GlobalTable"

@aws.SubResourceHint
open class AttributeDefinition extends formae.SubResource {
    attributeName: String
    attributeType: String
}

@aws.SubResourceHint
open class CapacityAutoScalingSettings extends formae.SubResource {
    maxCapacity: Int
    minCapacity: Int
    @aws.FieldHint{writeOnly = true}
    seedCapacity: Int?
    targetTrackingScalingPolicyConfiguration: TargetTrackingScalingPolicyConfiguration
}

@aws.SubResourceHint
open class ContributorInsightsSpecification extends formae.SubResource {
    enabled: Boolean
}

@aws.SubResourceHint
open class GlobalSecondaryIndex extends formae.SubResource {
    indexName: String
    keySchema: Listing<KeySchema>
    projection: Projection
    warmThroughput: WarmThroughput?
    writeOnDemandThroughputSettings: WriteOnDemandThroughputSettings?
    writeProvisionedThroughputSettings: WriteProvisionedThroughputSettings?
}

@aws.SubResourceHint
open class KeySchema extends formae.SubResource {
    attributeName: String
    keyType: String
}

typealias KinesisStreamSpecificationApproximateCreationDateTimePrecision = "MICROSECOND"|"MILLISECOND"

@aws.SubResourceHint
open class KinesisStreamSpecification extends formae.SubResource {
    approximateCreationDateTimePrecision: KinesisStreamSpecificationApproximateCreationDateTimePrecision?
    streamArn: String
}

@aws.SubResourceHint
open class LocalSecondaryIndex extends formae.SubResource {
    indexName: String
    keySchema: Listing<KeySchema>
    projection: Projection
}

@aws.SubResourceHint
open class PointInTimeRecoverySpecification extends formae.SubResource {
    pointInTimeRecoveryEnabled: Boolean?
    recoveryPeriodInDays: Int?
}

@aws.SubResourceHint
open class Projection extends formae.SubResource {
    nonKeyAttributes: Listing<String>?
    projectionType: String?
}

@aws.SubResourceHint
open class ReadOnDemandThroughputSettings extends formae.SubResource {
    maxReadRequestUnits: Int?
}

@aws.SubResourceHint
open class ReadProvisionedThroughputSettings extends formae.SubResource {
    readCapacityAutoScalingSettings: CapacityAutoScalingSettings?
    readCapacityUnits: Int?
}

@aws.SubResourceHint
open class ReplicaGlobalSecondaryIndexSpecification extends formae.SubResource {
    contributorInsightsSpecification: ContributorInsightsSpecification?
    indexName: String
    readOnDemandThroughputSettings: ReadOnDemandThroughputSettings?
    readProvisionedThroughputSettings: ReadProvisionedThroughputSettings?
}

@aws.SubResourceHint
open class ReplicaSSESpecification extends formae.SubResource {
    kMSMasterKeyId: String
}

@aws.SubResourceHint
open class Replica extends formae.SubResource {
    contributorInsightsSpecification: ContributorInsightsSpecification?
    deletionProtectionEnabled: Boolean?
    globalSecondaryIndexes: Listing<ReplicaGlobalSecondaryIndexSpecification>?
    kinesisStreamSpecification: KinesisStreamSpecification?
    pointInTimeRecoverySpecification: PointInTimeRecoverySpecification?
    readOnDemandThroughputSettings: ReadOnDemandThroughputSettings?
    readProvisionedThroughputSettings: ReadProvisionedThroughputSettings?
    region: aws.Region
    replicaStreamSpecification: ReplicaStreamSpecification?
    resourcePolicy: ResourcePolicy?
    sSESpecification: ReplicaSSESpecification?
    tableClass: String?
    tags: Listing<formae.Tag>?
}

@aws.SubResourceHint
open class ReplicaStreamSpecification extends formae.SubResource {
    resourcePolicy: ResourcePolicy
}

@aws.SubResourceHint
open class ResourcePolicy extends formae.SubResource {
    policyDocument: Dynamic
}

@aws.SubResourceHint
open class SSESpecification extends formae.SubResource {
    @aws.FieldHint{outputField = "SSEEnabled"}
    sseEnabled: Boolean
    @aws.FieldHint{outputField = "SSEType"}
    sseType: String?
}

@aws.SubResourceHint
open class StreamSpecification extends formae.SubResource {
    streamViewType: String
}

@aws.SubResourceHint
open class TargetTrackingScalingPolicyConfiguration extends formae.SubResource {
    disableScaleIn: Boolean?
    scaleInCooldown: Int?
    scaleOutCooldown: Int?
    targetValue: Number
}

@aws.SubResourceHint
open class TimeToLiveSpecification extends formae.SubResource {
    attributeName: String?
    enabled: Boolean
}

@aws.SubResourceHint
open class WarmThroughput extends formae.SubResource {
    readUnitsPerSecond: Int?
    writeUnitsPerSecond: Int?
}

@aws.SubResourceHint
open class WriteOnDemandThroughputSettings extends formae.SubResource {
    maxWriteRequestUnits: Int?
}

@aws.SubResourceHint
open class WriteProvisionedThroughputSettings extends formae.SubResource {
    writeCapacityAutoScalingSettings: CapacityAutoScalingSettings?
}

@aws.ResourceHint {
    type = module.type
    identifier = "TableName"
    tags = "Tags"
}
open class GlobalTable extends formae.Resource {

    @aws.FieldHint
    attributeDefinitions: Listing<AttributeDefinition>

    @aws.FieldHint
    billingMode: String?

    @aws.FieldHint
    globalSecondaryIndexes: Listing<GlobalSecondaryIndex>?

    @aws.FieldHint{createOnly = true}
    keySchema: Listing<KeySchema>

    @aws.FieldHint{createOnly = true}
    localSecondaryIndexes: Listing<LocalSecondaryIndex>?

    @aws.FieldHint
    pointInTimeRecoverySpecification: PointInTimeRecoverySpecification?

    @aws.FieldHint
    replicas: Listing<Replica>

    @aws.FieldHint{outputField = "SSESpecification"}
    sseSpecification: SSESpecification?

    @aws.FieldHint
    streamSpecification: StreamSpecification?

    @aws.FieldHint{createOnly = true}
    tableName: String?

    @aws.FieldHint
    timeToLiveSpecification: TimeToLiveSpecification?

    @aws.FieldHint
    warmThroughput: WarmThroughput?

    @aws.FieldHint
    writeOnDemandThroughputSettings: WriteOnDemandThroughputSettings?

    @aws.FieldHint
    writeProvisionedThroughputSettings: WriteProvisionedThroughputSettings?
}
